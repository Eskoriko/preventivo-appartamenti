<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preventivo Appartamenti 2026</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 1.8em;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 25px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: #444;
            font-weight: 600;
        }
        select, input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .checkbox-group input {
            width: auto;
        }
        
        /* Calendar Styles */
        .calendar-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .calendar-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.1em;
        }
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        .calendar-nav button {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        .calendar-nav button:hover {
            background: #5a6fd6;
        }
        .calendar-nav button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }
        .calendar-weekdays span {
            text-align: center;
            font-weight: bold;
            color: #666;
            font-size: 0.85em;
            padding: 5px;
        }
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 0.9em;
            color: #999;
            background: transparent;
            border: none;
            cursor: default;
        }
        .calendar-day.saturday {
            background: #e8f4fd;
            color: #1a5a8a;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .calendar-day.saturday:hover {
            background: #667eea;
            color: white;
            transform: scale(1.1);
        }
        .calendar-day.selected {
            background: #25D366;
            color: white;
        }
        .calendar-day.selected:hover {
            background: #1da851;
        }
        .calendar-day.empty {
            visibility: hidden;
        }
        .selected-date-display {
            text-align: center;
            padding: 10px;
            background: #e8f4fd;
            border-radius: 10px;
            margin-top: 15px;
            color: #1a5a8a;
            font-weight: 600;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            font-size: 0.8em;
            color: #666;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .legend-dot.available {
            background: #e8f4fd;
            border: 2px solid #1a5a8a;
        }
        .legend-dot.selected {
            background: #25D366;
        }
        
        .result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            text-align: center;
        }
        .total {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        .details {
            font-size: 0.9em;
            opacity: 0.9;
            line-height: 1.6;
        }
        .beach-discount {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
        }
        .btn-whatsapp {
            display: block;
            width: 100%;
            background: #25D366;
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            text-decoration: none;
            text-align: center;
            transition: background 0.3s, transform 0.2s;
        }
        .btn-whatsapp:hover {
            background: #128C7E;
            transform: translateY(-2px);
        }
        .btn-whatsapp::before {
            content: "üì± ";
        }
        .info-box {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.85em;
            color: #1a5a8a;
        }
        .info-box ul {
            margin: 10px 0 0 0;
            padding-left: 20px;
        }
        .info-box li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèñÔ∏è Preventivo Vacanza</h1>
        <p class="subtitle">Calcola il costo del tuo soggiorno</p>
        
        <div class="form-group">
            <label>üè† Appartamento</label>
            <select id="appartamento" onchange="calcolaPreventivo()">
                <option value="A1" data-max="4">A1 (2-4 persone)</option>
                <option value="A2" data-max="4">A2 (2-4 persone)</option>
                <option value="B" data-max="4">B (4 persone)</option>
                <option value="BB" data-max="2">BB (2 persone)</option>
                <option value="C" data-max="2">C (2 persone)</option>
                <option value="D" data-max="4">D (4 persone)</option>
                <option value="E" data-max="4">E (2-4 persone)</option>
                <option value="F" data-max="4">F (2-4 persone)</option>
            </select>
        </div>

        <div class="form-group">
            <label>üìÖ Seleziona data check-in (solo Sabato)</label>
            <div class="calendar-container">
                <div class="calendar-header">
                    <button class="calendar-nav" id="prevMonth" onclick="changeMonth(-1)">‚óÄ</button>
                    <h3 id="monthYear"></h3>
                    <button class="calendar-nav" id="nextMonth" onclick="changeMonth(1)">‚ñ∂</button>
                </div>
                <div class="calendar-weekdays">
                    <span>Lun</span>
                    <span>Mar</span>
                    <span>Mer</span>
                    <span>Gio</span>
                    <span>Ven</span>
                    <span>Sab</span>
                    <span>Dom</span>
                </div>
                <div class="calendar-days" id="calendarDays"></div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot available"></div>
                        <span>Check-in disponibile</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot selected"></div>
                        <span>Selezionato</span>
                    </div>
                </div>
                <div class="selected-date-display" id="selectedDateDisplay">
                    üëÜ Clicca su un sabato per selezionare il check-in
                </div>
            </div>
        </div>

        <div class="form-group">
            <label>üìÜ Numero settimane</label>
            <select id="settimane" onchange="calcolaPreventivo()">
                <option value="1">1 settimana</option>
                <option value="2">2 settimane</option>
                <option value="3">3 settimane</option>
                <option value="4">4 settimane</option>
            </select>
        </div>

        <div class="form-group">
            <label>üë• Numero persone</label>
            <select id="persone" onchange="calcolaPreventivo()">
                <option value="1">1 persona</option>
                <option value="2">2 persone</option>
                <option value="3">3 persone</option>
                <option value="4">4 persone</option>
            </select>
        </div>

        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="biancheria" onchange="calcolaPreventivo()">
                <label for="biancheria" style="margin: 0;">üõèÔ∏è Biancheria</label>
            </div>
        </div>

        <div class="form-group">
            <div class="checkbox-group">
                <input type="checkbox" id="cane" onchange="calcolaPreventivo()">
                <label for="cane" style="margin: 0;">üêï Cane</label>
            </div>
        </div>

        <div class="result" id="result">
            <div class="details" id="dettagli"></div>
            <div class="total" id="totale">‚Ç¨ 0</div>
            <div class="beach-discount" id="spiaggia"></div>
        </div>

        <div id="capacityWarning" class="warning" style="display: none;">
            ‚ö†Ô∏è Attenzione: hai selezionato pi√π persone della capienza massima dell'appartamento!
        </div>

        <a href="#" id="whatsappBtn" class="btn-whatsapp" onclick="inviaWhatsApp(event)">
            Richiedi Prenotazione
        </a>

        <div class="info-box">
            <strong>‚ÑπÔ∏è Cosa √® incluso:</strong>
            <ul>
                <li>Pulizie: ‚Ç¨50/settimana (incluse nel totale)</li>
                <li>Biancheria: ‚Ç¨10/giorno (1-2 pers.) o ‚Ç¨20/giorno (3-4 pers.)</li>
                <li>Cane: ‚Ç¨10/giorno</li>
                <li>Sconto spiaggia convenzionata (dalla 3¬™ fila)</li>
            </ul>
        </div>
    </div>

    <script>
        // Prezzi settimanali per appartamento e periodo
        const prezzi = {
            A1: { maggio: 300, giugno: 350, luglio1: 450, luglio2: 500, luglio3: 550, luglio4: 600, agosto1: 750, agosto2: 900, agosto3: 900, agosto4: 600, settembre: 350 },
            A2: { maggio: 300, giugno: 350, luglio1: 450, luglio2: 500, luglio3: 550, luglio4: 600, agosto1: 750, agosto2: 900, agosto3: 900, agosto4: 600, settembre: 350 },
            B: { maggio: 350, giugno: 450, luglio1: 550, luglio2: 600, luglio3: 700, luglio4: 750, agosto1: 900, agosto2: 1100, agosto3: 1100, agosto4: 700, settembre: 400 },
            BB: { maggio: 250, giugno: 280, luglio1: 350, luglio2: 400, luglio3: 450, luglio4: 500, agosto1: 600, agosto2: 700, agosto3: 700, agosto4: 500, settembre: 280 },
            C: { maggio: 250, giugno: 300, luglio1: 400, luglio2: 450, luglio3: 500, luglio4: 550, agosto1: 650, agosto2: 750, agosto3: 750, agosto4: 550, settembre: 300 },
            D: { maggio: 350, giugno: 450, luglio1: 550, luglio2: 600, luglio3: 700, luglio4: 750, agosto1: 900, agosto2: 1100, agosto3: 1100, agosto4: 700, settembre: 400 },
            E: { maggio: 300, giugno: 400, luglio1: 500, luglio2: 550, luglio3: 600, luglio4: 650, agosto1: 800, agosto2: 950, agosto3: 950, agosto4: 650, settembre: 350 },
            F: { maggio: 300, giugno: 400, luglio1: 500, luglio2: 550, luglio3: 600, luglio4: 650, agosto1: 800, agosto2: 950, agosto3: 950, agosto4: 650, settembre: 350 }
        };

        const scontiSpiaggia = {
            maggio: 50, giugno: 50, luglio1: 20, luglio2: 20, luglio3: 20, luglio4: 20,
            agosto1: 10, agosto2: 10, agosto3: 10, agosto4: 10, settembre: 50
        };

        // Mesi disponibili (Maggio - Settembre 2026)
        const mesiDisponibili = [
            { anno: 2026, mese: 4, nome: 'Maggio 2026' },
            { anno: 2026, mese: 5, nome: 'Giugno 2026' },
            { anno: 2026, mese: 6, nome: 'Luglio 2026' },
            { anno: 2026, mese: 7, nome: 'Agosto 2026' },
            { anno: 2026, mese: 8, nome: 'Settembre 2026' }
        ];

        let currentMonthIndex = 0;
        let selectedDate = null;
        let preventivo = {};

        // Funzione per determinare il periodo in base alla data
        function getPeriodo(date) {
            const mese = date.getMonth();
            const giorno = date.getDate();
            
            if (mese === 4) return 'maggio'; // Maggio
            if (mese === 5) return 'giugno'; // Giugno
            if (mese === 6) { // Luglio
                if (giorno <= 11) return 'luglio1';
                if (giorno <= 18) return 'luglio2';
                if (giorno <= 25) return 'luglio3';
                return 'luglio4';
            }
            if (mese === 7) { // Agosto
                if (giorno <= 8) return 'agosto1';
                if (giorno <= 15) return 'agosto2';
                if (giorno <= 22) return 'agosto3';
                return 'agosto4';
            }
            if (mese === 8) return 'settembre'; // Settembre
            return 'maggio';
        }

        function getNomePeriodo(periodo) {
            const nomi = {
                maggio: "Maggio", giugno: "Giugno", luglio1: "Luglio (1¬™ sett.)", luglio2: "Luglio (2¬™ sett.)",
                luglio3: "Luglio (3¬™ sett.)", luglio4: "Luglio (4¬™ sett.)", agosto1: "Agosto (1¬™ sett.)",
                agosto2: "Agosto (2¬™ sett.)", agosto3: "Agosto (3¬™ sett.)", agosto4: "Agosto (4¬™ sett.)", settembre: "Settembre"
            };
            return nomi[periodo] || periodo;
        }

        function formatDate(date) {
            const giorni = ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'];
            const mesi = ['Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 
                         'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'];
            return `${giorni[date.getDay()]} ${date.getDate()} ${mesi[date.getMonth()]} ${date.getFullYear()}`;
        }

        function formatDateShort(date) {
            return `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`;
        }

        function renderCalendar() {
            const meseCorrente = mesiDisponibili[currentMonthIndex];
            const primoGiorno = new Date(meseCorrente.anno, meseCorrente.mese, 1);
            const ultimoGiorno = new Date(meseCorrente.anno, meseCorrente.mese + 1, 0);
            
            document.getElementById('monthYear').textContent = meseCorrente.nome;
            
            // Abilita/disabilita pulsanti navigazione
            document.getElementById('prevMonth').disabled = currentMonthIndex === 0;
            document.getElementById('nextMonth').disabled = currentMonthIndex === mesiDisponibili.length - 1;
            
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';
            
            // Giorni vuoti prima del primo giorno del mese
            // getDay() restituisce 0 per Domenica, ma vogliamo Luned√¨ come primo giorno
            let startDay = primoGiorno.getDay();
            startDay = startDay === 0 ? 6 : startDay - 1; // Converti a Luned√¨ = 0
            
            for (let i = 0; i < startDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                calendarDays.appendChild(emptyDay);
            }
            
            // Giorni del mese
            for (let day = 1; day <= ultimoGiorno.getDate(); day++) {
                const date = new Date(meseCorrente.anno, meseCorrente.mese, day);
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                dayEl.textContent = day;
                
                // Sabato = 6
                if (date.getDay() === 6) {
                    dayEl.className += ' saturday';
                    dayEl.onclick = () => selectDate(date);
                    
                    // Controlla se √® selezionato
                    if (selectedDate && 
                        selectedDate.getDate() === day && 
                        selectedDate.getMonth() === meseCorrente.mese &&
                        selectedDate.getFullYear() === meseCorrente.anno) {
                        dayEl.className += ' selected';
                    }
                }
                
                calendarDays.appendChild(dayEl);
            }
        }

        function changeMonth(delta) {
            currentMonthIndex += delta;
            if (currentMonthIndex < 0) currentMonthIndex = 0;
            if (currentMonthIndex >= mesiDisponibili.length) currentMonthIndex = mesiDisponibili.length - 1;
            renderCalendar();
        }

        function selectDate(date) {
            selectedDate = date;
            renderCalendar();
            
            // Calcola check-out (sabato successivo)
            const checkOut = new Date(date);
            checkOut.setDate(checkOut.getDate() + 7);
            
            document.getElementById('selectedDateDisplay').innerHTML = 
                `‚úÖ Check-in: <strong>${formatDate(date)}</strong>`;
            
            calcolaPreventivo();
        }

        function calcolaPreventivo() {
            if (!selectedDate) {
                document.getElementById('dettagli').innerHTML = 'üëÜ Seleziona una data di check-in';
                document.getElementById('totale').textContent = '‚Ç¨ --';
                document.getElementById('spiaggia').innerHTML = '';
                return;
            }

            const appSelect = document.getElementById('appartamento');
            const app = appSelect.value;
            const maxPersone = parseInt(appSelect.options[appSelect.selectedIndex].dataset.max);
            const settimane = parseInt(document.getElementById('settimane').value);
            const persone = parseInt(document.getElementById('persone').value);
            const biancheria = document.getElementById('biancheria').checked;
            const cane = document.getElementById('cane').checked;

            // Warning capacit√†
            const warningEl = document.getElementById('capacityWarning');
            warningEl.style.display = persone > maxPersone ? 'block' : 'none';

            // Determina periodo dalla data selezionata
            const periodo = getPeriodo(selectedDate);
            
            // Calcola check-out
            const checkOut = new Date(selectedDate);
            checkOut.setDate(checkOut.getDate() + (7 * settimane));

            // Calcoli
            const prezzoBase = prezzi[app][periodo] * settimane;
            const pulizie = 50 * settimane;
            const giorniTotali = settimane * 7;
            
            let costoBiancheria = 0;
            if (biancheria) {
                costoBiancheria = persone <= 2 ? 10 * giorniTotali : 20 * giorniTotali;
            }
            
            const costoCane = cane ? 10 * giorniTotali : 0;
            const totale = prezzoBase + pulizie + costoBiancheria + costoCane;
            const scontoSpiaggia = scontiSpiaggia[periodo];

            // Salva preventivo per WhatsApp
            preventivo = {
                appartamento: app,
                checkIn: formatDateShort(selectedDate),
                checkOut: formatDateShort(checkOut),
                periodo: getNomePeriodo(periodo),
                settimane: settimane,
                persone: persone,
                biancheria: biancheria,
                cane: cane,
                prezzoBase: prezzoBase,
                pulizie: pulizie,
                costoBiancheria: costoBiancheria,
                costoCane: costoCane,
                totale: totale,
                scontoSpiaggia: scontoSpiaggia
            };

            // Mostra risultato
            let dettagli = `Appartamento ${app} ‚Ä¢ ${getNomePeriodo(periodo)}<br>`;
            dettagli += `üìÖ ${formatDateShort(selectedDate)} ‚Üí ${formatDateShort(checkOut)}<br>`;
            dettagli += `${settimane} settimana/e ‚Ä¢ ${persone} persona/e<br><br>`;
            dettagli += `Soggiorno: ‚Ç¨${prezzoBase}<br>`;
            dettagli += `Pulizie: ‚Ç¨${pulizie}`;
            if (biancheria) dettagli += `<br>Biancheria: ‚Ç¨${costoBiancheria}`;
            if (cane) dettagli += `<br>Cane: ‚Ç¨${costoCane}`;

            document.getElementById('dettagli').innerHTML = dettagli;
            document.getElementById('totale').textContent = `‚Ç¨ ${totale}`;
            document.getElementById('spiaggia').innerHTML = `üèñÔ∏è Sconto spiaggia convenzionata: <strong>${scontoSpiaggia}%</strong><br><small>(dalla 3¬™ fila in poi)</small>`;
        }

        function inviaWhatsApp(e) {
            e.preventDefault();
            
            if (!selectedDate) {
                alert('Seleziona prima una data di check-in!');
                return;
            }
            
            let messaggio = `Ciao! Vorrei prenotare:\n\n`;
            messaggio += `üè† Appartamento: ${preventivo.appartamento}\n`;
            messaggio += `üìÖ Check-in: ${preventivo.checkIn}\n`;
            messaggio += `üìÖ Check-out: ${preventivo.checkOut}\n`;
            messaggio += `üìÜ Settimane: ${preventivo.settimane}\n`;
            messaggio += `üë• Persone: ${preventivo.persone}\n`;
            messaggio += `üõèÔ∏è Biancheria: ${preventivo.biancheria ? 'S√¨' : 'No'}\n`;
            messaggio += `üêï Cane: ${preventivo.cane ? 'S√¨' : 'No'}\n\n`;
            messaggio += `üí∞ Totale preventivo: ‚Ç¨${preventivo.totale}\n\n`;
            messaggio += `Attendo conferma disponibilit√†. Grazie!`;

            const numeroWhatsApp = '393514707090';
            const url = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(messaggio)}`;
            window.open(url, '_blank');
        }

        // Inizializza
        renderCalendar();
        calcolaPreventivo();
    </script>
</body>
</html>